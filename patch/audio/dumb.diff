diff -ruN /usr/ports/audio/dumb/Makefile ./dumb/Makefile
--- /usr/ports/audio/dumb/Makefile	2013-07-13 22:41:06.000000000 +0200
+++ ./dumb/Makefile	2013-08-12 01:11:09.000000000 +0200
@@ -3,43 +3,64 @@
 
 PORTNAME=	dumb
 PORTVERSION=	0.9.3
-PORTREVISION=	3
+PORTREVISION=	4
 CATEGORIES=	audio
 MASTER_SITES=	SF
 
 MAINTAINER=	amdmi3@FreeBSD.org
 COMMENT=	IT, XM, S3M, and MOD player library
 
-USE_GMAKE=	yes
+USES=	gmake
+
+OPTIONS_RADIO=	ALLEGRO
+OPTIONS_RADIO_ALLEGRO=	ALLEGRO ALLEGRO_DEVEL
+
+OPTIONS_DEFAULT=	ALLEGRO_DEVEL
+
+OPTIONS_SUB=	yes
 
-OPTIONS_DEFINE=	ALLEGRO
 ALLEGRO_DESC=	Enable allegro support
+ALLEGRO_DEVEL_DESC=	Enable allegro development version
+
+ALLEGRO_LIB_DEPENDS=		alleg:${PORTSDIR}/devel/allegro
+ALLEGRO_DEVEL_LIB_DEPENDS=	liballegro.so:${PORTSDIR}/devel/allegro-devel
 
 .include <bsd.port.options.mk>
 
 .if ${PORT_OPTIONS:MALLEGRO}
-LIB_DEPENDS+=	alleg:${PORTSDIR}/devel/allegro
-PLIST_SUB+=	ALLEGRO=""
-MAKE_ARGS=	_PORT_ALLEGRO_CFLAGS="`allegro-config --cflags`"
+SET_ALLEGRO=	yes
 PKGNAMESUFFIX=	-allegro
 CONFLICTS=	dumb-[0-9]*
 .else
-PLIST_SUB+=	ALLEGRO="@comment "
-MAKE_ARGS=	_PORT_ALLEGRO_CFLAGS=
 CONFLICTS=	dumb-allegro-[0-9]*
 .endif
 
+.if ${PORT_OPTIONS:MALLEGRO_DEVEL}
+SET_ALLEGRO=	yes
+PKGNAMESUFFIX=	-allegro-devel
+CONFLICTS=	dumb-[0-9]*
+.else
+CONFLICTS=	dumb-allegro-devel-[0-9]*
+.endif
+
+.if defined(SET_ALLEGRO)
+MAKE_ARGS+=	_PORT_ALLEGRO_CFLAGS="`allegro-config --cflags`"
+.else
+MAKE_ARGS+=	_PORT_ALLEGRO_CFLAGS=
+.endif
+
 .if ${ARCH} == "amd64" || ${ARCH} == "ia64" || ${ARCH} == "sparc64"
 CFLAGS+=	-fPIC
 .endif
 
-pre-configure:
-	@${CP} ${FILESDIR}/config.txt ${WRKSRC}/make
-	@${REINPLACE_CMD} -e "s,@LOCALBASE@,${LOCALBASE}," ${WRKSRC}/make/config.txt
-.if ${PORT_OPTIONS:MALLEGRO}
-	@${REINPLACE_CMD} -e "s,@ALLEGRO@,," ${WRKSRC}/make/config.txt
+post-patch:
+	${CP} ${FILESDIR}/config.txt ${WRKSRC}/make
+	${REINPLACE_CMD} -e 's|@LOCALBASE@|${PREFIX}|' ${WRKSRC}/make/config.txt
+
+.if defined(SET_ALLEGRO)
+	${REINPLACE_CMD} -e 's|@ALLEGRO@ ||' ${WRKSRC}/make/config.txt
 .else
-	@${REINPLACE_CMD} -e "s,@ALLEGRO@,#," ${WRKSRC}/make/config.txt
+	${REINPLACE_CMD} -e 's|@ALLEGRO@ |#|' ${WRKSRC}/make/config.txt
 .endif
 
 .include <bsd.port.mk>
diff -ruN /usr/ports/audio/dumb/pkg-plist ./dumb/pkg-plist
--- /usr/ports/audio/dumb/pkg-plist	2013-06-02 19:00:39.000000000 +0200
+++ ./dumb/pkg-plist	2013-08-11 17:02:23.000000000 +0200
@@ -1,7 +1,10 @@
 %%ALLEGRO%%bin/dumbplay
+%%ALLEGRO_DEVEL%%bin/dumbplay
 bin/dumbout
 bin/dumb2wav
 include/dumb.h
 %%ALLEGRO%%include/aldumb.h
+%%ALLEGRO_DEVEL%%include/aldumb.h
 lib/libdumb.a
 %%ALLEGRO%%lib/libaldmb.a
+%%ALLEGRO_DEVEL%%lib/libaldmb.a
