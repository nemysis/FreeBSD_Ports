===> Generating patch
===> Viewing diff with more
diff -ruN --exclude=CVS /usr/ports/audio/vagalume/Makefile ./Makefile
--- /usr/ports/audio/vagalume/Makefile	2013-04-04 11:06:38.000000000 +0200
+++ ./Makefile	2013-04-04 11:26:49.000000000 +0200
@@ -5,19 +5,17 @@
 PORTVERSION=	0.8.5
 PORTREVISION=	2
 CATEGORIES=	audio
-MASTER_SITES=	http://vagalume.igalia.com/files/source/ \
-		${MASTER_SITE_DEBIAN_POOL}
-MASTER_SITE_SUBDIR=	pool/main/v/vagalume/
+MASTER_SITES=	http://vagalume.igalia.com/files/source/
 
 MAINTAINER=	decke@FreeBSD.org
-COMMENT=	A GTK+-based client for the Last.fm online radio
+COMMENT=	GTK+-based client for the Last.fm online radio
 
 LIB_DEPENDS=	xml2:${PORTSDIR}/textproc/libxml2 \
-		curl.6:${PORTSDIR}/ftp/curl
+		curl:${PORTSDIR}/ftp/curl
 
 GNU_CONFIGURE=	yes
 USE_GMAKE=	yes
-USE_GNOME=	gtk20
+USE_GNOME=	gtk20 desktopfileutils
 USE_PKGCONFIG=	build
 USE_GSTREAMER=	good mad gconf
 INSTALLS_ICONS=	yes
@@ -36,13 +34,13 @@
 LDFLAGS+=	-L${LOCALBASE}/lib
 PLIST_SUB+=	NLS=""
 .else
-CONFIGURE_ARGS+=--disable-nls
+CONFIGURE_ARGS+=	--disable-nls
 PLIST_SUB+=	NLS="@comment "
 .endif
 
 .if ${PORT_OPTIONS:MDBUS}
 CONFIGURE_ARGS+=--enable-dbus --enable-im-status
-LIB_DEPENDS+=	dbus-glib-1.2:${PORTSDIR}/devel/dbus-glib
+LIB_DEPENDS+=	dbus-glib:${PORTSDIR}/devel/dbus-glib
 PLIST_SUB+=	DBUS=""
 MAN1+=		vagalumectl.1
 .else
@@ -52,7 +50,7 @@
 
 .if ${PORT_OPTIONS:MTRAY}
 CONFIGURE_ARGS+=--enable-tray-icon
-BUILD_DEPENDS+=	${LOCALBASE}/libdata/pkgconfig/libnotify.pc:${PORTSDIR}/devel/libnotify
+BUILD_DEPENDS+=	notify-send:${PORTSDIR}/devel/libnotify
 LIB_DEPENDS+=	notify.4:${PORTSDIR}/devel/libnotify
 .else
 CONFIGURE_ARGS+=--disable-tray-icon
@@ -66,9 +64,13 @@
 post-patch:
 	@${REINPLACE_CMD} -e 's|serviceentrydir = @serviceentrydir@|serviceentrydir = ${PREFIX}/share/dbus-1/services|' \
 		${WRKSRC}/Makefile.in
-.if empty(PORT_OPTIONS:MNLS)
+.if ! ${PORT_OPTIONS:MNLS}
 	@${REINPLACE_CMD} -e 's|SUBDIRS = src po|SUBDIRS = src|' \
 		${WRKSRC}/Makefile.in
 .endif
 
+post-install:
+	${LN} -sf ${PREFIX}/share/icons/hicolor/48x48/apps/${PORTNAME}.png ${PREFIX}/share/pixmaps
+	@-update-desktop-database -q
+
 .include <bsd.port.mk>
diff -ruN --exclude=CVS /usr/ports/audio/vagalume/pkg-plist ./pkg-plist
--- /usr/ports/audio/vagalume/pkg-plist	2013-01-14 17:54:16.000000000 +0100
+++ ./pkg-plist	2013-04-03 03:58:21.000000000 +0200
@@ -1,21 +1,8 @@
-@comment $FreeBSD: head/audio/vagalume/pkg-plist 300895 2012-07-14 12:56:14Z beat $
 bin/vagalume
 %%DBUS%%bin/vagalumectl
 share/applications/vagalume.desktop
 %%DBUS%%share/dbus-1/services/vagalume.service
 share/icons/hicolor/48x48/apps/vagalume.png
-share/pixmaps/vagalume.xpm
-%%DATADIR%%/cover.png
-%%DATADIR%%/servers.xml
-%%DATADIR%%/icons/hicolor/scalable/apps/accessories-text-editor.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/document-save.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/emblem-favorite.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/list-add.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/mail-message-new.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/media-playback-start.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/media-playback-stop.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/media-skip-forward.svg
-%%DATADIR%%/icons/hicolor/scalable/apps/process-stop.svg
 %%NLS%%share/locale/ca/LC_MESSAGES/vagalume.mo
 %%NLS%%share/locale/de/LC_MESSAGES/vagalume.mo
 %%NLS%%share/locale/es/LC_MESSAGES/vagalume.mo
@@ -28,36 +15,24 @@
 %%NLS%%share/locale/pt/LC_MESSAGES/vagalume.mo
 %%NLS%%share/locale/pt_BR/LC_MESSAGES/vagalume.mo
 %%NLS%%share/locale/ru/LC_MESSAGES/vagalume.mo
+share/pixmaps/vagalume.xpm
+share/pixmaps/vagalume.png
+%%DATADIR%%/cover.png
+%%DATADIR%%/icons/hicolor/scalable/apps/accessories-text-editor.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/document-save.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/emblem-favorite.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/list-add.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/mail-message-new.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/media-playback-start.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/media-playback-stop.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/media-skip-forward.svg
+%%DATADIR%%/icons/hicolor/scalable/apps/process-stop.svg
+%%DATADIR%%/servers.xml
 @dirrm %%DATADIR%%/icons/hicolor/scalable/apps
 @dirrm %%DATADIR%%/icons/hicolor/scalable
 @dirrm %%DATADIR%%/icons/hicolor
 @dirrm %%DATADIR%%/icons
 @dirrm %%DATADIR%%
-@dirrmtry share/icons/hicolor/48x48/apps
-@dirrmtry share/icons/hicolor/48x48
-@dirrmtry share/icons/hicolor
-@dirrmtry share/icons
-%%NLS%%@dirrmtry share/locale/de/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/de
-%%NLS%%@dirrmtry share/locale/es/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/es
-%%NLS%%@dirrmtry share/locale/fi/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/fi
-%%NLS%%@dirrmtry share/locale/fr/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/fr
-%%NLS%%@dirrmtry share/locale/gl/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/gl
-%%NLS%%@dirrmtry share/locale/it/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/it
-%%NLS%%@dirrmtry share/locale/lv/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/lv
-%%NLS%%@dirrmtry share/locale/pl/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/pl
-%%NLS%%@dirrmtry share/locale/pt/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/pt
-%%NLS%%@dirrmtry share/locale/pt_BR/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/pt_BR
-%%NLS%%@dirrmtry share/locale/ru/LC_MESSAGES
-%%NLS%%@dirrmtry share/locale/ru
-%%NLS%%@dirrmtry share/locale
 @dirrmtry share/applications
+@exec %%LOCALBASE%%/bin/update-desktop-database -q || /usr/bin/true
+@unexec %%LOCALBASE%%/bin/update-desktop-database -q || /usr/bin/true
===> Done
