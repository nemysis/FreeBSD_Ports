===> Generating patch
===> Viewing diff with more
diff -ruN --exclude=CVS /usr/ports/graphics/fracplanet/Makefile ./Makefile
--- /usr/ports/graphics/fracplanet/Makefile	2013-02-01 13:15:22.000000000 +0100
+++ ./Makefile	2013-04-10 23:36:37.000000000 +0200
@@ -3,12 +3,17 @@
 
 PORTNAME=	fracplanet
 PORTVERSION=	0.4.0
-PORTREVISION=	4
+PORTREVISION=	5
 CATEGORIES=	graphics
-MASTER_SITES=	SF
+MASTER_SITES=	SF \
+		SF/nemysisfreebsdp/:icons
+DISTFILES=	${PORTNAME}-${DISTVERSION}${EXTRACT_SUFX} \
+		${PORTNAME}_icons.tar.gz:icons
 
-MAINTAINER=	ports@FreeBSD.org
-COMMENT=	An interactive generator of planets and terrain
+MAINTAINER=	nemysis@gmx.ch
+COMMENT=	Interactive tool for creating random fractal planets and terrain
+
+LICENSE=	GPLv2
 
 BUILD_DEPENDS=	xsltproc:${PORTSDIR}/textproc/libxslt
 LIB_DEPENDS=	boost_program_options:${PORTSDIR}/devel/boost-libs
@@ -16,8 +21,7 @@
 WRKSRC=		${WRKDIR}/${PORTNAME}
 
 USE_GL=		glu
-USE_QT4=	corelib gui opengl \
-		moc_build qmake_build
+USE_QT4=	corelib moc_build qmake_build gui opengl
 QT_NONSTANDARD=	yes
 HAS_CONFIGURE=	yes
 CONFIGURE_ENV=	QTDIR="${QT_PREFIX}"
@@ -25,23 +29,66 @@
 USE_GMAKE=	yes
 
 MAN1=		${PORTNAME}.1
-PORTDOCS=	${PORTNAME}.css ${PORTNAME}.htm
-PLIST_FILES=	bin/${PORTNAME}
+
+PORTDOCS=	*
+
+DOCSRCDIR1=	${WRKSRC}
+DOC_FILES1=	 BUGS NEWS README THANKS TODO ${PORTNAME}.css ${PORTNAME}.htm
+
+INSTALLS_ICONS=	yes
+ICON_SIZES=	32x32 48x48 64x64 72x72 96x96
+
+DESKTOP_ENTRIES="Fracplanet" "${COMMENT}" "${PORTNAME}" \
+		"${PORTNAME}" "Graphics;" false
+
+OPTIONS_GROUP=	DOXYGEN
+
+OPTIONS_GROUP_DOXYGEN=	HTML LATEX
+
+OPTIONS_DEFAULT=	HTML
+
+HTML_DESC=	Install HTML Doxygen files
+LATEX_DESC=	Install LaTeX Doxygen files
+
+.include <bsd.port.options.mk>
+
+.if ${PORT_OPTIONS:MHTML} || ${PORT_OPTIONS:MLATEX}
+BUILD_DEPENDS+=	doxygen:${PORTSDIR}/devel/doxygen
+.endif
 
 post-patch:
-.for file in BUILD VERSION configure
-	@${REINPLACE_CMD} -e \
-		'/^#!/s|/.*bash|/bin/sh|g' ${WRKSRC}/${file}
+.for f in BUILD VERSION configure mkdeb mktgz testtgz
+	@${REINPLACE_CMD} -e 's|/bin/bash|/bin/sh|g' \
+		${WRKSRC}/${f}
 .endfor
 
 do-install:
 	${INSTALL_PROGRAM} ${WRKSRC}/${PORTNAME} ${PREFIX}/bin
 	${INSTALL_MAN} ${WRKSRC}/man/man1/${PORTNAME}.1 ${MAN1PREFIX}/man/man1
-.if !defined(NOPORTDOCS)
-	@${MKDIR} ${DOCSDIR}
-.for file in ${PORTDOCS}
-	${INSTALL_DATA} ${WRKSRC}/${file} ${DOCSDIR}
+
+post-install:
+.for s in ${ICON_SIZES}
+	${MKDIR} ${PREFIX}/share/icons/hicolor/${s}/apps
+	${INSTALL_DATA} ${WRKDIR}/${PORTNAME}_${s}.png \
+		${PREFIX}/share/icons/hicolor/${s}/apps/${PORTNAME}.png
 .endfor
+	${LN} -sf ${PREFIX}/share/icons/hicolor/48x48/apps/${PORTNAME}.png ${PREFIX}/share/pixmaps
+
+.if ${PORT_OPTIONS:MDOCS}
+	@${MKDIR} ${DOCSDIR}
+	${INSTALL_DATA} ${DOC_FILES1:S|^|${DOCSRCDIR1}/|} ${DOCSDIR}
+.endif
+
+.if ${PORT_OPTIONS:MHTML} || ${PORT_OPTIONS:MLATEX}
+	@cd ${WRKSRC} && doxygen .
+.endif
+
+.if ${PORT_OPTIONS:MDOCS} && ${PORT_OPTIONS:MHTML}
+	@(cd ${WRKSRC} && ${COPYTREE_SHARE} html ${DOCSDIR})
+.endif
+
+.if ${PORT_OPTIONS:MDOCS} && ${PORT_OPTIONS:MLATEX}
+	@(cd ${WRKSRC} && ${COPYTREE_SHARE} latex ${DOCSDIR})
 .endif
 
 .include <bsd.port.mk>
diff -ruN --exclude=CVS /usr/ports/graphics/fracplanet/distinfo ./distinfo
--- /usr/ports/graphics/fracplanet/distinfo	2013-01-14 17:57:03.000000000 +0100
+++ ./distinfo	2013-04-10 23:37:07.000000000 +0200
@@ -1,2 +1,4 @@
 SHA256 (fracplanet-0.4.0.tar.gz) = 38d56aba3c5cf19d4f2c218bece471d3860b161d2210a24ba94550356723482a
 SIZE (fracplanet-0.4.0.tar.gz) = 101700
+SHA256 (fracplanet_icons.tar.gz) = 99eeb8ed62d45083138402c41b2af79a4b432bfcb8e63cbe83090bb2d235063b
+SIZE (fracplanet_icons.tar.gz) = 51712
diff -ruN --exclude=CVS /usr/ports/graphics/fracplanet/pkg-descr ./pkg-descr
--- /usr/ports/graphics/fracplanet/pkg-descr	2013-03-29 00:26:08.000000000 +0100
+++ ./pkg-descr	2012-11-10 20:48:23.000000000 +0100
@@ -3,4 +3,5 @@
 interactively and the results displayed using OpenGL. The generated
 objects can be dumped in Pov-Ray format.
 
-WWW: http://www.bottlenose.demon.co.uk/share/fracplanet
+WWW: http://www.bottlenose.demon.co.uk/share/fracplanet/
+WWW: http://sourceforge.net/projects/fracplanet/
diff -ruN --exclude=CVS /usr/ports/graphics/fracplanet/pkg-plist ./pkg-plist
--- /usr/ports/graphics/fracplanet/pkg-plist	1970-01-01 01:00:00.000000000 +0100
+++ ./pkg-plist	2013-03-29 00:57:04.000000000 +0100
@@ -0,0 +1,7 @@
+bin/fracplanet
+share/icons/hicolor/32x32/apps/fracplanet.png
+share/icons/hicolor/48x48/apps/fracplanet.png
+share/icons/hicolor/64x64/apps/fracplanet.png
+share/icons/hicolor/72x72/apps/fracplanet.png
+share/icons/hicolor/96x96/apps/fracplanet.png
+share/pixmaps/fracplanet.png
===> Done
