===> Generating patch
===> Viewing diff with more
diff -ruN --exclude=CVS /usr/ports/graphics/ampasCTL/Makefile ./Makefile
--- /usr/ports/graphics/ampasCTL/Makefile	2013-04-26 16:36:27.000000000 +0200
+++ ./Makefile	2013-05-22 12:21:06.000000000 +0200
@@ -1,7 +1,5 @@
 # Created by: nork@FreeBSD.org
-#
 # $FreeBSD: head/graphics/ampasCTL/Makefile 316343 2013-04-23 10:47:02Z bapt $
-#
 
 PORTNAME=	ampasCTL
 PORTVERSION=	1.4.1
@@ -16,26 +14,39 @@
 
 LIB_DEPENDS=	Imath:${PORTSDIR}/graphics/ilmbase
 
-USES=		pkgconfig
+USES=		pathfix pkgconfig
 USE_LDCONFIG=	yes
 GNU_CONFIGURE=	yes
 USE_AUTOTOOLS=	libtool
 
-PORTDOCS=	AUTHORS ChangeLog NEWS README
+PORTDOCS=	*
+
+DOCSRCDIR1=	${WRKSRC}
+DOC_FILES1=	AUTHORS ChangeLog NEWS README
+DOC_FILES2=	CtlManual.pdf CtlManual.doc
 
 .include <bsd.port.options.mk>
 
 test check:	build
-	@(cd ${WRKSRC}; ${SETENV} ${MAKE_ENV} ${MAKE} ${MAKE_FLAGS} ${MAKEFILE} ${MAKE_ARGS} check)
+	@(cd ${WRKSRC} ; ${SETENV} ${MAKE_ENV} ${MAKE} ${MAKE_FLAGS} ${MAKEFILE} ${MAKE_ARGS} check)
 
 .if defined(PACKAGE_BUILDING)
 pre-install:	test
 .endif
 
+post-patch:
+	@${REINPLACE_CMD} -e 's|$$(datadir)/doc/CTL-@CTL_VERSION@|$$(datadir)/doc/ampasCTL|' \
+		${WRKSRC}/doc/Makefile.in
+
+.if ! ${PORT_OPTIONS:MDOCS}
+	@${REINPLACE_CMD} -e 's|CtlManual.pdf CtlManual.doc||' \
+		${WRKSRC}/doc/Makefile.in
+.endif
+
 post-install:
 .if ${PORT_OPTIONS:MDOCS}
-	${MKDIR} ${DOCSDIR}
-	${INSTALL_DATA} ${PORTDOCS:S|^|${WRKSRC}/|} ${DOCSDIR}
+	@${MKDIR} ${DOCSDIR}
+	${INSTALL_DATA} ${DOC_FILES1:S|^|${DOCSRCDIR1}/|} ${DOCSDIR}
 .endif
 
 .include <bsd.port.mk>
diff -ruN --exclude=CVS /usr/ports/graphics/ampasCTL/files/patch-Makefile.in ./files/patch-Makefile.in
--- /usr/ports/graphics/ampasCTL/files/patch-Makefile.in	2013-01-14 17:57:08.000000000 +0100
+++ ./files/patch-Makefile.in	1970-01-01 01:00:00.000000000 +0100
@@ -1,11 +0,0 @@
---- Makefile.in.orig	2007-08-04 09:11:41.000000000 +0900
-+++ Makefile.in	2007-10-08 06:50:25.000000000 +0900
-@@ -203,7 +203,7 @@
- 	AUTHORS COPYING ChangeLog INSTALL LICENSE NEWS \
-         README README.CVS README.OSX README.win32 bootstrap
- 
--pkgconfigdir = $(libdir)/pkgconfig
-+pkgconfigdir = $(prefix)/libdata/pkgconfig
- pkgconfig_DATA = CTL.pc
- all: all-recursive
- 
diff -ruN --exclude=CVS /usr/ports/graphics/ampasCTL/files/patch-doc-Makefile.in ./files/patch-doc-Makefile.in
--- /usr/ports/graphics/ampasCTL/files/patch-doc-Makefile.in	2013-01-14 17:57:08.000000000 +0100
+++ ./files/patch-doc-Makefile.in	1970-01-01 01:00:00.000000000 +0100
@@ -1,11 +0,0 @@
---- doc/Makefile.in.orig	2007-08-04 09:11:41.000000000 +0900
-+++ doc/Makefile.in	2007-10-08 06:51:25.000000000 +0900
-@@ -171,7 +171,7 @@
- sysconfdir = @sysconfdir@
- target_alias = @target_alias@
- EXTRA_DIST = CtlManual.pdf CtlManual.doc
--docdir = $(datadir)/doc/CTL-@CTL_VERSION@
-+docdir = $(datadir)/doc/ampasCTL
- doc_DATA = $(EXTRA_DIST)
- all: all-am
- 
diff -ruN --exclude=CVS /usr/ports/graphics/ampasCTL/pkg-descr ./pkg-descr
--- /usr/ports/graphics/ampasCTL/pkg-descr	2013-01-17 13:26:13.000000000 +0100
+++ ./pkg-descr	2013-05-26 20:11:22.000000000 +0200
@@ -19,6 +19,6 @@
 
 IlmCtlTest      Confidence tests for IlmImfCtl
 
-WWW:	http://www.openexr.com/
-WWW:	http://www.oscars.org/science-technology/council/projects/ctl.html
-WWW:	http://ampasctl.sourceforge.net/
+WWW: http://www.openexr.com/
+WWW: http://www.oscars.org/science-technology/council/projects/ctl.html
+WWW: http://ampasctl.sourceforge.net/
diff -ruN --exclude=CVS /usr/ports/graphics/ampasCTL/pkg-plist ./pkg-plist
--- /usr/ports/graphics/ampasCTL/pkg-plist	2013-01-17 13:26:13.000000000 +0100
+++ ./pkg-plist	2013-03-24 21:53:58.000000000 +0100
@@ -32,8 +32,4 @@
 lib/libIlmCtlSimd.so
 lib/libIlmCtlSimd.so.2
 libdata/pkgconfig/CTL.pc
-%%PORTDOCS%%%%DOCSDIR%%/CtlManual.doc
-%%PORTDOCS%%%%DOCSDIR%%/CtlManual.pdf
-%%PORTDOCS%%@dirrmtry %%DOCSDIR%%
-@dirrmtry share/applications
 @dirrmtry include/CTL
===> Done
